<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tic-Tac-Toe | Крестики-Нолики</title>
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        /* Дополнительные стили для главного меню */
        .game-container {
            display: none !important;
        }
        
        .main-menu {
            display: flex !important;
            flex-direction: column;
            gap: 30px;
        }
        
        .menu-cards {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
        }
        
        .menu-card {
            background: var(--bg-card);
            border-radius: 12px;
            padding: 20px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
            border: 2px solid transparent;
            position: relative;
            overflow: hidden;
        }
        
        .menu-card:hover {
            transform: translateY(-5px);
            border-color: var(--primary-color);
            box-shadow: 0 10px 20px rgba(255, 107, 53, 0.3);
        }
        
        .menu-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: linear-gradient(90deg, #FF6B35, #FF3D00);
        }
        
        .card-icon {
            font-size: 36px;
            color: var(--primary-color);
            margin-bottom: 15px;
        }
        
        .menu-card h3 {
            font-size: 18px;
            margin-bottom: 8px;
            color: white;
        }
        
        .menu-card p {
            font-size: 14px;
            color: #B0B0B0;
            margin-bottom: 12px;
        }
        
        .card-badge {
            display: inline-block;
            padding: 4px 12px;
            background: var(--primary-color);
            color: white;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 600;
        }
        
        .bottom-actions {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 10px;
            margin-top: 20px;
        }
        
        .game-title {
            text-align: center;
            font-size: 28px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 15px;
            color: #FFA726;
            text-shadow: 0 2px 10px rgba(255, 107, 53, 0.5);
        }
        
        /* Мобильная адаптация */
        @media (max-width: 480px) {
            .menu-cards {
                grid-template-columns: 1fr;
            }
            
            .bottom-actions {
                grid-template-columns: 1fr;
            }
            
            .game-title {
                font-size: 22px;
                flex-direction: column;
                gap: 10px;
            }
        }
        
        /* Скрываем все ненужные элементы */
        #game-container {
            display: none !important;
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Шапка -->
        <header class="header">
            <div class="user-info">
                <div class="avatar" id="userAvatar">
                    <i class="fas fa-user"></i>
                </div>
                <div class="user-details">
                    <span class="username" id="username">Игрок</span>
                    <div class="balances">
                        <div class="balance real-balance">
                            <i class="fas fa-coins"></i>
                            <span id="realBalance">0.00</span>
                        </div>
                        <div class="balance game-balance">
                            <i class="fas fa-gamepad"></i>
                            <span id="gameBalance">100</span>
                        </div>
                    </div>
                </div>
            </div>
            <div class="header-actions">
                <button class="btn-icon" id="profileBtn" title="Профиль">
                    <i class="fas fa-user-circle"></i>
                </button>
                <button class="btn-icon" id="historyBtn" title="История">
                    <i class="fas fa-history"></i>
                </button>
                <button class="btn-icon" id="adminBtn" title="Админ-панель" style="display: none;">
                    <i class="fas fa-cog"></i>
                </button>
                <button class="btn-icon" id="partnerBtn" title="Партнёр-панель" style="display: none;">
                    <i class="fas fa-handshake"></i>
                </button>
            </div>
        </header>

        <!-- ГЛАВНОЕ МЕНЮ (ПОКАЗЫВАЕТСЯ ПО УМОЛЧАНИЮ) -->
        <main class="main-menu">
            <h1 class="game-title">
                <i class="fas fa-times" style="color: #FF6B35;"></i>
                <span>КРЕСТИКИ-НОЛИКИ</span>
                <i class="far fa-circle" style="color: #2196F3;"></i>
            </h1>
            
            <div class="menu-cards">
                <div class="menu-card" id="playWithBot">
                    <div class="card-icon"><i class="fas fa-robot"></i></div>
                    <h3>Игра с ботом</h3>
                    <p>Против ИИ-соперника</p>
                    <div class="card-badge">Бесплатно</div>
                </div>
                
                <div class="menu-card" id="playOnline">
                    <div class="card-icon"><i class="fas fa-globe"></i></div>
                    <h3>Онлайн игра</h3>
                    <p>С реальными игроками</p>
                    <div class="card-badge">Ставки</div>
                </div>
                
                <div class="menu-card" id="createLobby">
                    <div class="card-icon"><i class="fas fa-plus-circle"></i></div>
                    <h3>Создать лобби</h3>
                    <p>Пригласи друга</p>
                    <div class="card-badge">Приватно</div>
                </div>
                
                <div class="menu-card" id="quickPlay">
                    <div class="card-icon"><i class="fas fa-bolt"></i></div>
                    <h3>Быстрая игра</h3>
                    <p>Найти соперника</p>
                    <div class="card-badge">Рейтинг</div>
                </div>
            </div>
            
            <div class="bottom-actions">
                <button class="btn-primary" id="depositBtn">
                    <i class="fas fa-wallet"></i> Пополнить
                </button>
                <button class="btn-secondary" id="withdrawBtn">
                    <i class="fas fa-money-bill-wave"></i> Вывести
                </button>
                <button class="btn-outline" id="rulesBtn">
                    <i class="fas fa-book"></i> Правила
                </button>
            </div>
        </main>

        <!-- Игровое поле (СКРЫТО по умолчанию) -->
        <div id="game-container" class="game-container">
            <!-- Будет создано динамически -->
        </div>
    </div>

    <!-- Модальное окно ставок -->
    <div class="modal" id="betModal" style="display: none;">
        <div class="modal-content">
            <h2>Сделайте ставку</h2>
            <div class="bet-options">
                <div class="balance-selector">
                    <h3>Тип баланса:</h3>
                    <div class="radio-group">
                        <label class="radio-label">
                            <input type="radio" name="balanceType" value="game" checked>
                            <span>Игровой баланс</span>
                        </label>
                        <label class="radio-label">
                            <input type="radio" name="balanceType" value="real">
                            <span>Реальный баланс</span>
                        </label>
                    </div>
                </div>
                
                <div class="stake-amount">
                    <h3>Сумма ставки:</h3>
                    <div class="amount-buttons">
                        <button class="amount-btn" data-amount="10">10</button>
                        <button class="amount-btn" data-amount="50">50</button>
                        <button class="amount-btn" data-amount="100">100</button>
                        <button class="amount-btn" data-amount="500">500</button>
                        <button class="amount-btn" data-amount="1000">1000</button>
                    </div>
                    <div class="custom-amount">
                        <input type="number" id="customAmount" placeholder="Другая сумма" min="1">
                    </div>
                </div>
                
                <div class="commission-notice" id="commissionNotice" style="display: none;">
                    <i class="fas fa-info-circle"></i>
                    <span>При выигрыше бот удержит 5% комиссии</span>
                </div>
            </div>
            <div class="modal-actions">
                <button class="btn-secondary" id="cancelBet">Отмена</button>
                <button class="btn-primary" id="confirmBet">Играть</button>
            </div>
        </div>
    </div>

    <!-- Подключение скриптов -->
    <script src="config.js"></script>
    <script src="storage.js"></script>
    <script src="auth.js"></script>
    <script>
        // Сначала инициализируем базовые функции
        function getCurrentUser() {
            const userId = localStorage.getItem('currentUserId');
            const users = JSON.parse(localStorage.getItem('ticTacToeUsers') || '[]');
            return users.find(u => u.id == userId);
        }
        
        function updateBalanceDisplay() {
            const user = getCurrentUser();
            if (!user) return;
            
            document.getElementById('realBalance').textContent = (user.realBalance || 0).toFixed(2);
            document.getElementById('gameBalance').textContent = (user.gameBalance || 0).toFixed(0);
        }
    </script>
    <script src="main-simple.js"></script>
</body>
</html>
